<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" content="notranslate">
    <title>JUNIOR PRIVATE HUB | Admin Vault</title>
    <style>
        :root { --gold: #D4AF37; --white: #F5F5F5; --green: #00FF41; --bg: #000000; --red: #FF3131; --blue: #007BFF; }
        body { background: var(--bg); color: var(--white); font-family: 'Courier New', monospace; margin: 0; padding: 10px; }
        .hub-container { max-width: 480px; margin: auto; border: 2px solid var(--gold); padding: 15px; border-radius: 20px; text-align: center; }
        
        /* Message Bubbles */
        .msg-container { display: flex; flex-direction: column; height: 380px; overflow-y: auto; padding: 10px; background: rgba(10,10,10,0.9); border-radius: 12px; border: 1px solid #222; }
        .first-user-msg { align-self: flex-start; background: #111; color: var(--green); border: 1px solid var(--green); padding: 10px; border-radius: 15px 15px 15px 0; margin: 5px 0; max-width: 85%; }
        .second-user-msg { align-self: flex-end; background: #222; color: var(--white); border: 1px solid var(--white); padding: 10px; border-radius: 15px 15px 0 15px; margin: 5px 0; max-width: 85%; }
        
        /* Buttons & Inputs */
        .btn { padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; text-transform: uppercase; width: 100%; margin-top: 10px; }
        .btn-gold { background: var(--gold); color: #000; }
        .btn-green { background: var(--green); color: #000; }
        .btn-blue { background: var(--blue); color: #fff; }
        input, textarea { width: 92%; padding: 12px; background: #000; border: 1px solid #333; color: white; border-radius: 8px; margin-bottom: 10px; text-align: center; }
        
        .admin-label { color: var(--red); font-size: 0.6rem; font-weight: bold; margin-bottom: 5px; }
    </style>
</head>
<body class="notranslate">

<div class="hub-container">
    <h1 style="color:var(--gold);">JUNIOR PRIVATE HUB üõ°Ô∏è</h1>
    
    <div id="loginPage">
        <h3>üîí ACCESS CONTROL</h3>
        <input type="password" id="vaultPass" placeholder="Weka Passcode">
        <button class="btn btn-gold" onclick="accessVault()">FUNGUA MFUMO</button>
        <p style="font-size:0.6rem; color:#444;">Default Pass: 1234 | Admin: 7676</p>
    </div>

    <div id="adminPanel" style="display:none;">
        <div class="admin-label">‚ö†Ô∏è ADMIN SECRET MODE ACTIVE</div>
        <div style="background:#111; padding:15px; border-radius:12px; border:1px solid var(--red); margin-bottom:15px;">
            <h4 style="color:var(--red); margin:0;">MASTER BACKUP</h4>
            <button class="btn btn-blue" onclick="downloadBackup()">üì• DOWNLOAD ALL DATA (JSON)</button>
            <button class="btn" style="background:#333; color:white;" onclick="location.reload()">LOGOUT ADMIN</button>
        </div>
        <div id="adminRoomsList"></div>
    </div>

    <div id="registryPage" style="display:none;">
        <div style="text-align:left; background:#111; padding:15px; border-radius:12px; border:1px solid var(--gold);">
            <strong style="color:var(--gold);">üóÉÔ∏è ROOM REGISTRY</strong>
            <div id="keysList" style="margin:10px 0;"></div>
            <input type="text" id="regName" placeholder="Jina la Room Mpya">
            <button class="btn btn-gold" onclick="createNewKey()">SAVE & GENERATE ROOM</button>
        </div>
        <button class="btn" style="background:var(--red); color:white" onclick="location.reload()">EXIT HUB</button>
    </div>

    <div id="chatRoom" style="display:none;">
        <h4 id="activeRoomName" style="color:var(--gold);"></h4>
        <div class="msg-container" id="chatMatrix"></div>
        <textarea id="msgIn" placeholder="Andika ujumbe..."></textarea>
        <div style="display:flex; gap:10px;">
            <button class="btn btn-green" style="flex:1" onclick="sendMsg('first')">SAY (OWNER)</button>
            <button class="btn" style="flex:1; background:white; color:black;" onclick="sendMsg('second')">REPLY (GUEST)</button>
        </div>
        <button class="btn" style="background:#333; color:white; width:50%;" onclick="exitChat()">BACK</button>
    </div>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('junior_db') || '{"pass":"1234", "admin":"7676", "rooms":{}}');
    let currentRoom = null;

    function accessVault() {
        const pass = document.getElementById('vaultPass').value;
        if(pass === db.admin) {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
            renderAdminRooms();
        } else if(pass === db.pass) {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('registryPage').style.display = 'block';
            renderRegistry();
        } else { alert("Passcode Sio Sahihi!"); }
    }

    function renderAdminRooms() {
        const list = document.getElementById('adminRoomsList');
        list.innerHTML = "<h5 style='color:var(--gold)'>ALL ACTIVE ROOMS:</h5>";
        for(let code in db.rooms) {
            list.innerHTML += `
                <div style="padding:10px; background:#1a1a1a; margin-bottom:5px; border-radius:5px; border:1px solid var(--red); text-align:left;">
                    <b style="color:var(--gold)">${db.rooms[code].name}</b> (${code})<br>
                    <small>Messages: ${db.rooms[code].chats.length}</small>
                    <button onclick="openChat('${code}')" style="background:none; border:none; color:var(--green); cursor:pointer; float:right;">VIEW</button>
                </div>`;
        }
    }

    function downloadBackup() {
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(db));
        const downloadAnchorNode = document.createElement('a');
        downloadAnchorNode.setAttribute("href", dataStr);
        downloadAnchorNode.setAttribute("download", "JUNIOR_HUB_BACKUP_" + new Date().toLocaleDateString() + ".json");
        document.body.appendChild(downloadAnchorNode);
        downloadAnchorNode.click();
        downloadAnchorNode.remove();
    }

    function createNewKey() {
        const name = document.getElementById('regName').value;
        if(!name) return;
        const code = 'T-Junior/' + Math.random().toString(36).substr(2, 6).toUpperCase();
        db.rooms[code] = { name: name, chats: [] };
        save(); renderRegistry();
        document.getElementById('regName').value = "";
    }

    function renderRegistry() {
        const list = document.getElementById('keysList');
        list.innerHTML = "";
        for(let code in db.rooms) {
            list.innerHTML += `<div style="padding:10px; background:#1a1a1a; margin-bottom:5px; border-radius:5px; border-left:3px solid var(--gold)" onclick="openChat('${code}')">
                <b>${db.rooms[code].name}</b> <br> <small>${code}</small></div>`;
        }
    }

    function openChat(code) {
        currentRoom = code;
        document.getElementById('registryPage').style.display = 'none';
        document.getElementById('adminPanel').style.display = 'none';
        document.getElementById('chatRoom').style.display = 'block';
        document.getElementById('activeRoomName').innerText = "VAULT: " + db.rooms[code].name;
        loadMessages();
    }

    function loadMessages() {
        const box = document.getElementById('chatMatrix');
        box.innerHTML = db.rooms[currentRoom].chats.map((c, i) => `
            <div class="${c.user === 'first' ? 'first-user-msg' : 'second-user-msg'}">
                <div style="font-size:0.85rem">${c.text}</div>
                <small style="font-size:0.6rem; color:var(--red); cursor:pointer;" onclick="deleteMsg(${i})">Futa</small>
            </div>`).join('');
        box.scrollTop = box.scrollHeight;
    }

    function sendMsg(userType) {
        const text = document.getElementById('msgIn').value;
        if(!text) return;
        db.rooms[currentRoom].chats.push({ text: text, user: userType, time: Date.now() });
        save(); document.getElementById('msgIn').value = ""; loadMessages();
    }

    function deleteMsg(index) {
        db.rooms[currentRoom].chats.splice(index, 1);
        save(); loadMessages();
    }

    function save() { localStorage.setItem('junior_db', JSON.stringify(db)); }
    function exitChat() { location.reload(); }
</script>
</body>
</html>
