<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" content="notranslate">
    <title>JUNIOR PRIVAT HUB | Professional Vault</title>
    <style>
        :root { --gold: #D4AF37; --milk: #fcfcfc; --bg: #050505; --black: #000000; }
        body { background: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; }
        .hub-container { max-width: 450px; margin: auto; border: 2px solid var(--gold); padding: 20px; border-radius: 25px; background: #000; box-shadow: 0 0 30px rgba(212,175,55,0.15); }
        
        /* Chat Design */
        .chat-box { height: 480px; overflow-y: auto; display: flex; flex-direction: column; background: #0a0a0a; padding: 10px; border-radius: 15px; border: 1px solid #1a1a1a; margin-bottom: 10px; }
        .msg { padding: 12px; border-radius: 15px; margin: 5px 0; max-width: 80%; color: #000; font-weight: 500; }
        
        /* Buttons & Inputs */
        .btn { padding: 14px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; text-transform: uppercase; }
        .btn-gold { background: var(--gold); color: #000; }
        .btn-milk { background: var(--milk); color: #000; }
        .btn-red { background: #ff3131; color: #fff; }
        
        input { width: 92%; padding: 14px; background: #111; border: 1px solid #333; color: #fff; border-radius: 12px; margin-bottom: 15px; text-align: center; }
        .setup-box { background: #111; padding: 15px; border-radius: 15px; border: 1px solid var(--gold); }
    </style>
</head>
<body class="notranslate">

<div class="hub-container">
    <h2 style="color:var(--gold); text-align:center;">JUNIOR PRIVATE HUB üõ°Ô∏è</h2>

    <div id="loginSection">
        <p style="font-size: 0.9rem; color: #aaa;">Weka Passcode kuingia:</p>
        <input type="password" id="mainPass" placeholder="Ingiza Passcode">
        <button class="btn btn-gold" onclick="checkAccess()">FUNGUA MFUMO</button>
    </div>

    <div id="setupSection" style="display:none;">
        <div class="setup-box">
            <h4 style="color:var(--gold); margin-top:0;">üÜï ANZA ROOM MPYA</h4>
            <p style="font-size: 0.75rem;">Umeingia na kodi ya kuanzia. Jaza taarifa hapa chini:</p>
            <input type="text" id="newRoomName" placeholder="Jina la Room (Mfn: Secret Base)">
            <input type="password" id="newRoomPass" placeholder="Weka Password Mpya ya Room">
            <button class="btn btn-gold" onclick="saveNewRoom()">SAVE & CREATE ROOM</button>
        </div>
    </div>

    <div id="chatSection" style="display:none;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <span id="displayRoomName" style="color:var(--gold); font-weight:bold;"></span>
            <button class="btn btn-red" style="width:auto; padding:5px 15px; font-size:0.6rem;" onclick="location.reload()">LOGOUT</button>
        </div>
        <div class="chat-box" id="matrix"></div>
        
        <div style="display:flex; gap:10px;">
            <input type="text" id="msgIn" placeholder="Andika ujumbe..." style="margin-bottom:0;">
            <button class="btn btn-gold" style="width:auto; padding:0 20px;" onclick="send()">TUMA</button>
        </div>
    </div>
</div>

<script>
    // Database
    let db = JSON.parse(localStorage.getItem('JUNIOR_SECURE_VAULT') || '{"rooms":{}}');
    let currentRoomKey = "";

    function checkAccess() {
        const pass = document.getElementById('mainPass').value;
        
        if (pass === "1234") {
            // Fungua sehemu ya kutengeneza room mpya
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('setupSection').style.display = 'block';
        } else if (db.rooms[pass]) {
            // Kama password ipo kwenye database, fungua room husika
            currentRoomKey = pass;
            openRoom();
        } else {
            alert("Passcode haitambuliki! Tumia 1234 kama ni mara ya kwanza.");
        }
    }

    function saveNewRoom() {
        const rName = document.getElementById('newRoomName').value;
        const rPass = document.getElementById('newRoomPass').value;

        if (!rName || !rPass) return alert("Jaza Jina na Password!");
        if (rPass === "1234") return alert("Huwezi kutumia 1234 kama password ya kudumu!");

        // Hifadhi room mpya
        db.rooms[rPass] = {
            name: rName,
            chats: [],
            colors: ["#D4AF37", "#fcfcfc", "#3498db", "#2ecc71", "#e67e22", "#9b59b6", "#1abc9c"]
        };
        
        localStorage.setItem('JUNIOR_SECURE_VAULT', JSON.stringify(db));
        currentRoomKey = rPass;
        alert("Room Imetengenezwa! Tumia '" + rPass + "' kuingia tena.");
        openRoom();
    }

    function openRoom() {
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('setupSection').style.display = 'none';
        document.getElementById('chatSection').style.display = 'block';
        document.getElementById('displayRoomName').innerText = "ROOM: " + db.rooms[currentRoomKey].name;
        loadChats();
    }

    function loadChats() {
        const matrix = document.getElementById('matrix');
        const room = db.rooms[currentRoomKey];
        
        matrix.innerHTML = room.chats.map((c, i) => {
            // Panga rangi kwa watumiaji (hapa tunatumia rangi 2 za mwanzo kwa mfano huu)
            const bg = c.role === 'owner' ? 'var(--gold)' : 'var(--milk)';
            const align = c.role === 'owner' ? 'flex-start' : 'flex-end';
            
            return `
                <div class="msg" style="background:${bg}; align-self:${align}">
                    <div style="font-size:0.8rem;">${c.text}</div>
                    <div style="font-size:0.5rem; opacity:0.5; text-align:right;">${c.time}</div>
                </div>`;
        }).join('');
        matrix.scrollTop = matrix.scrollHeight;
    }

    function send() {
        const txt = document.getElementById('msgIn').value;
        if(!txt) return;

        const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        
        // Tambua kama ni mmiliki au mgeni (Hapa mmiliki ndio aliyeingia na Pass ya chumba)
        db.rooms[currentRoomKey].chats.push({
            text: txt,
            role: 'owner', // Hii inaweza kubadilika ukiwa na watumiaji wengi
            time: time
        });

        localStorage.setItem('JUNIOR_SECURE_VAULT', JSON.stringify(db));
        document.getElementById('msgIn').value = "";
        loadChats();
    }
</script>
</body>
</html>
