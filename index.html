<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JUNIOR PRIVATE HUB</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        body { 
            background-color: #0d1117; 
            color: #c9d1d9; 
            font-family: sans-serif; 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
        }

        /* LOGIN BOX */
        .login-card { 
            background: #161b22; 
            padding: 30px; 
            border-radius: 15px; 
            width: 90%; 
            max-width: 350px; 
            text-align: center; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h2 { color: #2ea44f; margin-bottom: 20px; }
        
        input { 
            width: 100%; 
            padding: 12px; 
            margin: 10px 0; 
            border-radius: 8px; 
            border: 1px solid #30363d; 
            background: #0d1117; 
            color: white; 
            box-sizing: border-box;
        }

        button { 
            width: 100%; 
            padding: 12px; 
            background: #2ea44f; 
            border: none; 
            color: white; 
            font-weight: bold; 
            border-radius: 8px; 
            cursor: pointer; 
            margin-top: 10px;
        }

        .guest-link { 
            margin-top: 15px; 
            font-size: 13px; 
            color: #8b949e; 
        }

        .guest-link span { color: #2ea44f; cursor: pointer; text-decoration: underline; }

        /* CHAT AREA */
        #chat-interface { display: none; width: 100%; height: 100vh; flex-direction: column; background: #0d1117; }
        .header { background: #161b22; padding: 15px; border-bottom: 1px solid #30363d; display: flex; justify-content: space-between; }
        #messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        .msg { padding: 10px; border-radius: 10px; max-width: 70%; font-size: 14px; }
        .mine { align-self: flex-end; background: #238636; }
        .theirs { align-self: flex-start; background: #30363d; }
        .footer { padding: 15px; background: #161b22; display: flex; gap: 10px; }
        #text-input { flex: 1; padding: 10px; border-radius: 20px; border: 1px solid #30363d; background: #0d1117; color: white; }
    </style>
</head>
<body>

<div id="login-screen" class="login-card">
    <h2>Junior Private Hub</h2>
    <p style="font-size: 12px;">Ingiza taarifa kuingia chumbani</p>
    <input type="text" id="username" placeholder="Jina lako">
    <input type="text" id="roomid" placeholder="ID ya Chumba (Password)">
    <button onclick="joinRoom()">ENTER THE ROOM</button>
    
    <div class="guest-link">
        Don't have a password? <span onclick="alert('Andika neno lolote unalotaka kwenye ID ya Chumba, kisha hilo neno wape marafiki zako nao waandike hivyohivyo ili muingie chumba kimoja!')">Create your own room</span>
    </div>
</div>

<div id="chat-interface">
    <div class="header">
        <span>Room: <b id="current-room" style="color:#2ea44f"></b></span>
        <span onclick="location.reload()" style="color:#f85149; cursor:pointer;">Logout</span>
    </div>
    <div id="messages"></div>
    <div class="footer">
        <input type="text" id="text-input" placeholder="Andika ujumbe...">
        <button onclick="sendMessage()" style="width: auto; margin: 0; padding: 10px 20px;">Tuma</button>
    </div>
</div>

<script>
    // Config yako ya Firebase (Iliyorekebishwa)
    const firebaseConfig = {
        apiKey: "AIzaSyBY_Tgf5XhAfAR7sgE7SVPYSU1QjkWvh6Y",
        authDomain: "privet-house--room.firebaseapp.com",
        databaseURL: "https://privet-house--room-default-rtdb.firebaseio.com",
        projectId: "privet-house--room",
        storageBucket: "privet-house--room.firebasestorage.app",
        messagingSenderId: "528726280084",
        appId: "1:528726280084:web:96dc8caa7b1c082527f181"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    let myName, myRoom;

    function joinRoom() {
        myName = document.getElementById('username').value.trim();
        myRoom = document.getElementById('roomid').value.trim();

        if (myName === "" || myRoom === "") {
            alert("Tafadhali jaza nafasi zote!");
            return;
        }

        // Ficha login, onyesha chat
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('chat-interface').style.display = 'flex';
        document.getElementById('current-room').innerText = myRoom;

        // Anza kusikiliza meseji
        const roomRef = database.ref('chats/' + myRoom);
        roomRef.on('child_added', (data) => {
            const val = data.val();
            const msgDiv = document.createElement('div');
            msgDiv.classList.add('msg');
            msgDiv.classList.add(val.user === myName ? 'mine' : 'theirs');
            msgDiv.innerHTML = `<b>${val.user}</b><br>${val.text}`;
            document.getElementById('messages').appendChild(msgDiv);
            
            // Auto scroll kwenda chini
            const chatBox = document.getElementById('messages');
            chatBox.scrollTop = chatBox.scrollHeight;
        });
    }

    function sendMessage() {
        const input = document.getElementById('text-input');
        if (input.value.trim() !== "") {
            database.ref('chats/' + myRoom).push({
                user: myName,
                text: input.value
            });
            input.value = "";
        }
    }
</script>

</body>
</html>
