<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JUNIOR HUB | Chronos Protocol</title>
    <style>
        :root { --green: #00ff41; --gold: #D4AF37; --bg: #000; }
        * { font-family: 'Courier New', monospace; box-sizing: border-box; }
        body { background: var(--bg); color: var(--green); margin: 0; padding: 10px; overflow-x: hidden; }
        .main-frame { max-width: 480px; margin: auto; border: 1px solid var(--green); padding: 15px; position: relative; }
        
        /* Dynamic Chronometer Style */
        #chronometer { font-size: 0.75rem; background: #111; padding: 8px; border-radius: 5px; border: 1px solid var(--gold); color: var(--gold); text-align: center; margin-bottom: 10px; display: none; }
        
        .terminal { height: 450px; overflow-y: auto; background: #050505; border: 1px solid #222; padding: 10px; display: flex; flex-direction: column; }
        .log-entry { padding: 8px; margin: 5px 0; max-width: 85%; border: 1px solid #333; font-size: 0.85rem; position: relative; }
        .owner-log { align-self: flex-end; background: #111; color: var(--gold); border-left: 3px solid var(--gold); }
        .guest-log { align-self: flex-start; background: #000; color: var(--green); border-left: 3px solid var(--green); }
        
        .input-area { width: 100%; background: #000; border: 1px solid var(--green); color: var(--green); padding: 12px; margin-top: 10px; outline: none; }
        .btn-exe { width: 100%; padding: 12px; background: transparent; border: 1px solid var(--green); color: var(--green); cursor: pointer; text-transform: uppercase; font-weight: bold; margin-top: 5px; }
        .btn-exe:hover { background: var(--green); color: #000; }
        .meta-info { font-size: 0.6rem; opacity: 0.6; margin-top: 4px; }
    </style>
</head>
<body>

<div class="main-frame">
    <div id="chronometer">INITIALIZING SENSOR...</div>

    <div id="gate">
        <h3 style="text-align:center; color:var(--gold);">[ DARK HUB ACCESS ]</h3>
        <input type="password" id="passKey" class="input-area" placeholder="ENTER SECTOR KEY (1234 TO CREATE)">
        <button class="btn-exe" onclick="accessVault()">BYPASS FIREWALL</button>
    </div>

    <div id="generator" style="display:none;">
        <p>[ NEW SECTOR AUTHORIZATION ]</p>
        <input type="text" id="newName" class="input-area" placeholder="ASSIGN SECTOR ID">
        <input type="password" id="newKey" class="input-area" placeholder="SET ENCRYPTION KEY">
        <button class="btn-exe" onclick="generate()">EXECUTE GENERATION</button>
    </div>

    <div id="core" style="display:none;">
        <div style="display:flex; justify-content:space-between; font-size:0.7rem; margin-bottom:5px;">
            <span id="activeID" style="color:var(--gold);"></span>
            <span style="color:red; cursor:pointer;" onclick="terminate()">[ TERMINATE ]</span>
        </div>
        <div class="terminal" id="display"></div>
        <textarea id="msg" class="input-area" placeholder="ENCRYPT MESSAGE..."></textarea>
        <button class="btn-exe" onclick="transmit()">TRANSMIT</button>
    </div>
</div>

<script>
    let vault = JSON.parse(localStorage.getItem('PROTOCOL_X_V6') || '{"sectors":{}}');
    let activeKey = "";
    let userAlias = "";
    let clockInterval;

    // --- CHRONOMETER ENGINE ---
    function updateClock() {
        const now = new Date();
        const d = now.toLocaleDateString();
        const t = now.getHours().toString().padStart(2, '0') + ":" + 
                  now.getMinutes().toString().padStart(2, '0') + ":" + 
                  now.getSeconds().toString().padStart(2, '0') + ":" + 
                  now.getMilliseconds().toString().padStart(3, '0');
        document.getElementById('chronometer').innerText = `[ SESSION ACTIVE ] TAREHE: ${d} | TIME: ${t}`;
    }

    // --- AUTO-DESTRUCT LOGIC (5 DAYS) ---
    function checkExpiry() {
        const now = Date.now();
        const expiryTime = 5 * 24 * 60 * 60 * 1000; // 5 Days in ms
        for (let k in vault.sectors) {
            if (now - vault.sectors[k].lastUsed > expiryTime) {
                delete vault.sectors[k]; // Futa kabisa
            }
        }
        localStorage.setItem('PROTOCOL_X_V6', JSON.stringify(vault));
    }

    function accessVault() {
        checkExpiry();
        const key = document.getElementById('passKey').value;
        if(key === "1234") {
            document.getElementById('gate').style.display = 'none';
            document.getElementById('generator').style.display = 'block';
        } else if(vault.sectors[key]) {
            activeKey = key;
            userAlias = prompt("ENTER YOUR OPERATIVE ALIAS:") || "ANON";
            startSession();
        } else { alert("ACCESS DENIED: KEY INVALID OR SECTOR EXPIRED."); }
    }

    function generate() {
        const id = document.getElementById('newName').value;
        const key = document.getElementById('newKey').value;
        if(!id || !key) return;
        vault.sectors[key] = { name: id, logs: [], lastUsed: Date.now() };
        localStorage.setItem('PROTOCOL_X_V6', JSON.stringify(vault));
        alert("SECTOR " + id + " CREATED. DURATION: 5 DAYS.");
        location.reload();
    }

    function startSession() {
        document.getElementById('gate').style.display = 'none';
        document.getElementById('core').style.display = 'block';
        document.getElementById('chronometer').style.display = 'block';
        document.getElementById('activeID').innerText = "SECTOR: " + vault.sectors[activeKey].name;
        
        // Washa Saa
        clockInterval = setInterval(updateClock, 1);
        
        // Update Last Used
        vault.sectors[activeKey].lastUsed = Date.now();
        localStorage.setItem('PROTOCOL_X_V6', JSON.stringify(vault));
        renderLogs();
    }

    function renderLogs() {
        const display = document.getElementById('display');
        const sector = vault.sectors[activeKey];
        display.innerHTML = sector.logs.map(l => {
            const isOwner = l.u.toUpperCase() === sector.name.toUpperCase();
            return `
                <div class="log-entry ${isOwner ? 'owner-log' : 'guest-log'}">
                    <div style="font-size:0.6rem; font-weight:bold;">[ ${l.u} ]</div>
                    ${l.t}
                    <div class="meta-info">STAMP: ${l.tm}</div>
                </div>`;
        }).join('');
        display.scrollTop = display.scrollHeight;
    }

    function transmit() {
        const txt = document.getElementById('msg').value;
        if(!txt) return;
        const time = new Date().toLocaleTimeString();
        vault.sectors[activeKey].logs.push({ u: userAlias, t: txt, tm: time });
        vault.sectors[activeKey].lastUsed = Date.now(); // Reset 5-day timer
        localStorage.setItem('PROTOCOL_X_V6', JSON.stringify(vault));
        renderLogs();
        document.getElementById('msg').value = "";
    }

    function terminate() {
        clearInterval(clockInterval);
        location.reload();
    }
</script>
</body>
</html>
