<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JUNIOR PRIVATE HUB</title>
    <style>
        :root { --gold: #D4AF37; --bg: #000; --card: #111; }
        * { font-family: 'Courier New', monospace; box-sizing: border-box; }
        body { background: var(--bg); color: #fff; margin: 0; padding: 10px; }
        
        .main-container { max-width: 450px; margin: auto; border: 2px solid var(--gold); border-radius: 25px; padding: 20px; min-height: 95vh; background: #000; }
        
        /* Saa ya Milisec */
        #chronos { font-size: 0.7rem; color: var(--gold); text-align: center; border: 1px solid #222; padding: 8px; border-radius: 10px; margin-bottom: 15px; display: none; }
        
        /* Chat Design */
        .matrix-display { height: 420px; overflow-y: auto; display: flex; flex-direction: column; background: #050505; padding: 10px; border-radius: 15px; border: 1px solid #222; margin-bottom: 10px; }
        .bubble { padding: 12px; border-radius: 15px; margin: 8px 0; max-width: 85%; color: #000; font-weight: bold; font-family: sans-serif; }
        .owner { align-self: flex-end; background: #fff; border-radius: 15px 15px 2px 15px; } 
        .guest { align-self: flex-start; background: #e2e2e2; border-radius: 15px 15px 15px 2px; }
        
        .sender-tag { font-size: 0.6rem; display: block; margin-bottom: 3px; color: #666; text-transform: uppercase; }
        .time-tag { font-size: 0.5rem; opacity: 0.6; text-align: right; margin-top: 4px; }

        input, textarea { width: 100%; padding: 15px; background: #1a1a1a; border: 1px solid #333; color: #fff; border-radius: 12px; margin-bottom: 10px; outline: none; }
        .btn { padding: 15px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; width: 100%; text-transform: uppercase; }
        .btn-gold { background: var(--gold); color: #000; margin-bottom: 15px; }
        .btn-dark { background: #222; color: var(--gold); font-size: 0.75rem; }
        .btn-red { background: #ff3333; color: #fff; width: auto; padding: 5px 15px; }

        .tools { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        img { width: 100%; border-radius: 10px; margin-top: 5px; }
    </style>
</head>
<body>

<div class="main-container">
    <h2 style="text-align:center; color:var(--gold);">JUNIOR PRIVATE HUB üõ°Ô∏è</h2>
    <div id="chronos"></div>

    <div id="loginGate">
        <p style="text-align:center; font-size:0.75rem; color:#888;">ENTER INFORMATION ACCORDING TO ROOM</p>
        <input type="text" id="userAlias" placeholder="Your Name (Example: JUNIOR)">
        <input type="password" id="roomPasscode" placeholder="Enter Room Password">
        <button class="btn btn-gold" onclick="attemptLogin()">OPEN THE SYSTEM</button>
        
        <button class="btn btn-dark" onclick="triggerSetup()">MAKE A NEW ROOM (1234)</button>
    </div>

    <div id="setupGate" style="display:none;">
        <p style="text-align:center; color:var(--gold);">[ NEW ROOM AUTHORIZATION ]</p>
        <input type="text" id="newRoomID" placeholder="Assign Room Name (Identity)">
        <input type="password" id="newRoomKey" placeholder="Set Room Password">
        <button class="btn btn-gold" onclick="finalizeRoom()">SAVE & GENERATE ROOM</button>
        <button class="btn btn-dark" onclick="location.reload()">CANCEL</button>
    </div>

    <div id="hubCore" style="display:none;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
            <span id="roomStatus" style="color:var(--gold); font-size:0.8rem; font-weight:bold;"></span>
            <button class="btn btn-red" onclick="location.reload()">EXIT</button>
        </div>
        
        <div class="matrix-display" id="chatScreen"></div>
        
        <div class="tools">
            <button class="btn btn-dark" onclick="document.getElementById('pic').click()">üì∑ PICHA</button>
            <button class="btn btn-dark" onclick="sendGPS()">üìç MAPS</button>
        </div>
        
        <input type="file" id="pic" style="display:none" accept="image/*" onchange="uploadPic(this)">
        <textarea id="textIn" placeholder="Andika ujumbe hapa..."></textarea>
        <button class="btn btn-gold" onclick="pushData()">TUMA UJUMBE</button>
    </div>
</div>

<script>
    let storage = JSON.parse(localStorage.getItem('JUNIOR_PRO_HUB_V9') || '{"sectors":{}}');
    let currentKey = "";
    let currentName = "";

    // 1. Trigger Setup kwa 1234
    function triggerSetup() {
        let code = prompt("Ingiza 1234 kwanza!");
        if(code === "1234") {
            document.getElementById('loginGate').style.display = 'none';
            document.getElementById('setupGate').style.display = 'block';
        } else { alert("Code siyo sahihi!"); }
    }

    // 2. Hifadhi Chumba Kipya
    function finalizeRoom() {
        const name = document.getElementById('newRoomID').value;
        const key = document.getElementById('newRoomKey').value;
        if(name && key) {
            storage.sectors[key] = { name: name, logs: [], lastIn: Date.now() };
            localStorage.setItem('JUNIOR_PRO_HUB_V9', JSON.stringify(storage));
            alert("Chumba cha " + name + " kimeundwa!");
            location.reload();
        }
    }

    // 3. Jaribu Kuingia
    function attemptLogin() {
        currentName = document.getElementById('userAlias').value;
        currentKey = document.getElementById('roomPasscode').value;
        
        if(storage.sectors[currentKey]) {
            // Check expiry ya siku 5
            const s5 = 5 * 24 * 60 * 60 * 1000;
            if(Date.now() - storage.sectors[currentKey].lastIn > s5) {
                delete storage.sectors[currentKey];
                localStorage.setItem('JUNIOR_PRO_HUB_V9', JSON.stringify(storage));
                return alert("Chumba kimefutika kwa kutotumika siku 5!");
            }
            
            launchHub();
        } else { alert("Chumba hakipo! Hakikisha Password ni sahihi."); }
    }

    // 4. Fungua Chumba
    function launchHub() {
        document.getElementById('loginGate').style.display = 'none';
        document.getElementById('hubCore').style.display = 'block';
        document.getElementById('chronos').style.display = 'block';
        document.getElementById('roomStatus').innerText = "ROOM: " + storage.sectors[currentKey].name;
        
        setInterval(() => {
            const n = new Date();
            document.getElementById('chronos').innerText = `[ SESSION ] ${n.toLocaleDateString()} | ${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}:${n.getMilliseconds()}`;
        }, 1);
        
        storage.sectors[currentKey].lastIn = Date.now();
        localStorage.setItem('JUNIOR_PRO_HUB_V9', JSON.stringify(storage));
        render();
    }

    function render() {
        const screen = document.getElementById('chatScreen');
        const rName = storage.sectors[currentKey].name.toUpperCase();
        screen.innerHTML = storage.sectors[currentKey].logs.map(l => {
            const isOwner = l.u.toUpperCase() === rName;
            return `<div class="bubble ${isOwner ? 'owner' : 'guest'}">
                        <span class="sender-tag">${l.u}</span>
                        ${l.t}
                        <div class="time-tag">${l.tm}</div>
                    </div>`;
        }).join('');
        screen.scrollTop = screen.scrollHeight;
    }

    function pushData() {
        const val = document.getElementById('textIn').value;
        if(!val) return;
        storage.sectors[currentKey].logs.push({ u: currentName, t: val, tm: new Date().toLocaleTimeString() });
        localStorage.setItem('JUNIOR_PRO_HUB_V9', JSON.stringify(storage));
        render(); document.getElementById('textIn').value = "";
    }

    function uploadPic(input) {
        if(input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                storage.sectors[currentKey].logs.push({ u: currentName, t: `<img src="${e.target.result}">`, tm: new Date().toLocaleTimeString() });
                localStorage.setItem('JUNIOR_PRO_HUB_V9', JSON.stringify(storage));
                render();
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function sendGPS() {
        navigator.geolocation.getCurrentPosition(p => {
            const url = `https://www.google.com/maps?q=${p.coords.latitude},${p.coords.longitude}`;
            storage.sectors[currentKey].logs.push({ u: currentName, t: `üìç Location: <a href="${url}" target="_blank" style="color:blue;">View on Maps</a>`, tm: new Date().toLocaleTimeString() });
            localStorage.setItem('JUNIOR_PRO_HUB_V9', JSON.stringify(storage));
            render();
        });
    }
</script>
</body>
</html>
